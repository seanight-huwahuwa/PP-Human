# ファイル名: docker-compose.yml
services:
  paddle-dev:
    build: .
    container_name: pp_human_container
    # WSL2 の Docker で GPU を利用するための設定
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    # 現在のフォルダ（~/PP-Human）をコンテナ内の /workspace にマウント
    volumes:
      - ./:/workspace
      - /tmp/.X11-unix:/tmp/.X11-unix  # （任意）GUI 表示が必要な場合に使用
    # 共有メモリサイズを拡張（AI モデルの読み込み時に推奨）
    shm_size: '16gb'
    # コンテナが停止しないように設定
    tty: true
    stdin_open: true
    restart: unless-stopped

    devices:
      - /dev/video0:/dev/video0  # ホストの video0 をコンテナに接続
    privileged: true             # ハードウェアアクセス権を付与